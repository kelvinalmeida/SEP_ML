<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Create Domain</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" />
    <style>
        .section-title {
            font-weight: bold;
            font-size: 1.2rem;
            color: #333;
            margin-top: 20px;
        }

        .card-section {
            background-color: #f9f9f9;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 30px;
        }

        .exercise-card {
            background-color: #fff;
            border: 1px solid #ddd;
            border-radius: 8px;
        }
    </style>
</head>

<body class="bg-light">
    <div class="container mt-5 mb-5">
        <div class="card shadow">
            <div class="card-header bg-primary text-white">
                <h4>Create New Domain</h4>
            </div>
            <div class="card-body">
                <form method="POST" enctype="multipart/form-data">

                    <!-- Se√ß√£o: Informa√ß√µes do Dom√≠nio -->
                    <div class="card-section">
                        <div class="section-title">üìò Domain Information</div>
                        <div class="mb-3">
                            <label class="form-label">Name</label>
                            <input type="text" name="name" class="form-control" required />
                        </div>

                        <div class="mb-3">
                            <label class="form-label">Description</label>
                            <textarea name="description" class="form-control" style="height: 150px;"></textarea>
                        </div>
                    </div>

                    <!-- Se√ß√£o: V√≠deo -->
                    <div class="card-section">
                        <div class="section-title">üé¨ Video</div>
                        <div class="mb-3">
                            <label class="form-label">Upload a Video</label>
                            <input type="file" name="video_file" class="form-control" accept="video/*">
                        </div>

                        <div class="mb-3">
                            <label class="form-label">YouTube Video Link</label>
                            <input type="url" name="youtube_link" class="form-control"
                                placeholder="https://www.youtube.com/watch?v=...">
                        </div>
                    </div>

                    <!-- Se√ß√£o: Upload de PDFs -->
                    <div class="card-section">
                        <div class="section-title">üìÑ PDF Upload</div>
                        <div id="pdf-container">
                            <input type="file" name="pdfs" class="form-control mb-2" accept=".pdf"
                                onchange="addPdfInput(this)" />
                        </div>
                    </div>

                    <!-- Se√ß√£o: Exerc√≠cios -->
                    <div class="card-section">
                        <div class="section-title">üìù Exercises</div>
                        <div id="exercise-container"></div>
                        <button type="button" class="btn btn-outline-primary mt-2" onclick="addExercise()">+ Add
                            Exercise</button>
                    </div>

                    <div class="text-end">
                        <button type="submit" class="btn btn-success">‚úÖ Criar Dom√≠nio</button>
                    </div>
                </form>

                <!-- Flash messages -->
                {% with messages = get_flashed_messages() %}
                {% if messages %}
                <div class="alert alert-info mt-4">
                    <ul class="mb-0">
                        {% for message in messages %}
                        <li>{{ message }}</li>
                        {% endfor %}
                    </ul>
                </div>
                {% endif %}
                {% endwith %}
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script>
        function addPdfInput(input) {
            if (input.files.length > 0) {
                const container = document.getElementById('pdf-container');
                const newInput = document.createElement('input');
                newInput.type = 'file';
                newInput.name = 'pdfs';
                newInput.className = 'form-control mb-2';
                newInput.accept = '.pdf';
                newInput.onchange = function () {
                    addPdfInput(this);
                };
                container.appendChild(newInput);
            }
        }

        let exerciseCount = 0;
        function addExercise() {
            const container = document.getElementById('exercise-container');
            const index = exerciseCount++;

            const exerciseDiv = document.createElement('div');
            exerciseDiv.className = 'exercise-card p-3 mb-4 position-relative';
            exerciseDiv.setAttribute('data-index', index);

            exerciseDiv.innerHTML = `
        <button type="button" class="btn btn-danger btn-sm position-absolute top-0 end-0 m-2" onclick="removeExercise(this)">
          Remover
        </button>

        <div class="mb-2">
          <label class="form-label">Question:</label>
          <input type="text" name="exercises[${index}][question]" class="form-control" required>
        </div>

        ${[0, 1, 2, 3, 4].map(i => `
          <div class="mb-2">
            <label class="form-label">Option ${String.fromCharCode(65 + i)}:</label>
            <input type="text" name="exercises[${index}][options][${i}]" class="form-control" required>
          </div>
        `).join('')}

        <div class="mb-2">
          <label class="form-label">Correct Option:</label>
          <select name="exercises[${index}][correct]" class="form-select" required>
            <option value="" disabled selected>Select the correct answer</option>
            <option value="0">Option A</option>
            <option value="1">Option B</option>
            <option value="2">Option C</option>
            <option value="3">Option D</option>
            <option value="4">Option E</option>
          </select>
        </div>
      `;

            container.appendChild(exerciseDiv);
        }

        function removeExercise(button) {
            const exerciseDiv = button.closest('.exercise-card');
            exerciseDiv.remove();
        }
    </script>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
</body>

</html>